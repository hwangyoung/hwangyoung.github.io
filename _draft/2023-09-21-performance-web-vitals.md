---
title: "Core Web Vitals"
last_modified_at: 2023-09-21T00:00-00:00
categories:
- performance
tags:
- web
- web vitals
toc: true
toc_sticky: true
---

웹 성능은 페이지가 로드되는 속도와 페이지가 사용자 입려에 반응하는 정도에 초점을 맞춘 웹 개발의 중요한 측면이다.
성능 향상을 위해 웹사이트를 최적화하면 사용자에게 더 나은 환경을 제공할 수 있다.
더 나은 사용자 환경은 웹사이트의 목표를 달성하는데 큰 도움이 된다.

웹 성능은 틈새 주제처럼 보일 수 있지만 사실은 광범위하면서도 깊이 있는 주제이다.
하나의 분야로서 그 깊이를 고려하면, 웹 성능에 관한 과정은 접근하기 쉬우면서도 유익한 정보를 제공한다.

점점 더 많은 소비자가 디지털 콘텐츠와 서비스를 이용하기 위해 웹에 의존하고 있다.
웹사이트 분석을 보면 이 이야기가 자체 데이터에서 작동하는 것을 볼 수 있다.
소비자의 요구가 그 어느 때보다 까다로워지고 있다.
소지자는 웹사이트를 경험하면 경쟁업체와 비교할 뿐 아니라 매일 사용하는 동급 최고의 서비스와 비교해 여러분을 평가한다.

성과와 비즈니스 성공 간의 관계에 대해 수행된 몇 가지 연구를 요약하고, 속도가 온라인 벤처가 얼마나 성공할 수 있는지에 있어 결정적인 요소 중 하나인 이유ㄹ 설명한다.

# 실적은 사용자 유지가 중요하다.

성능은 모든 온라인 벤처의 성공에 중요한 역할을 한다.
빠르게 로드되고 사용자 입력에 적시에 응답하는 웹사이트는 로드 속도가 느리고 속도가 느린 웹사이트보다 사용자의 참여를 더 잘 이끌어내고 유지한다.

e.g. BBC 사이트를 로드하는 데 1초가 걸릴 때 마다 10%의 사용자를 더 잃는다는 사실을 발견했다. 

Google에서는 Core Web Vitals 라는 것을 만들어 사용자 중심 성능 측정항목을 정의 하였다.

# 성능의 핵심은 사용자 경험이다.

사용자 경험에서 속도가 중요하다. 
한 [소비자 연구](https://www.ericsson.com/en/press-releases/2016/2/streaming-delays-mentally-taxing-for-smartphone-users-ericsson-mobility-report)에 따르면 페이지 속도 지연으로 인한 스트레스 반응은 공포영화를 보거나 수학적 문제를 해결하는 것과 유사하며, 소매점에서 계산대에서 기다리는 것보다 높았다.

페이지가 로드되기 시할할 때 사용자가 콘텐츠가 표시될 때까지 기다리는 시간이 있다.
이 작업이 완료되기전에는 별다른 사용자 경험이 없다.
빠른 연결에서는 이러한 경험 부족이 잠깐 발생한다.
그러나 연결이 느린 경우 사용자는 더 많은 문제를 경험할 수 있다.

![](https://web.dev/static/learn/performance/why-speed-matters/image/fig-1_856.png?hl=ko)

성능은 좋은 사용자 환경의 기본적인 측면이다.
사이트에서 많은 양의 코드를 제공하면 브라우저는 사용자 데이터 요금제에서 수 메가바이트의 데이터를 사용하여 다운로드 한다.
휴대기기는 cpu 성능과 메모리가 제한되었 있다.
이로 인해 성능 조건이 저하될 수 있으며 사용자의 행동을 알면 사용자가 웹사이트의 악조건을 해결할 수 있다.


웹 바이탈은 웹에서 우수한 사용자 환경을 제공하는 데 필수적인 품질 신호에 관한 통합가이드를 제공하기 위한 Google의 계획(명세)이다.
웹바이탈은 환경을 간소화하고 사이트가 가장 중요한 측정항목인 코어 웹 타이탈에 집중할 수 있도록 돕는 것을 목표로 한다.

# Core Web Vitals

코어 웹 바이탈은 모든 웹페이지에 적용되는 웹 바이탈의 하위 집합으로, 모든 사이트 소유자가 측정해야 하며 모든 Google 도구에 표시된다.
각 코어 웹 바이탈은 사용자 환경의 고유한 측면을 나타내며, 현장에서 측정 가능하며, 중요한 사용자 중심 결과의 실제 환경을 반영한다.

코어 웹 바이탈을 구성하는 측정항목은 시간이 지남에 따라 진화한다.
현재 설정은 사용자 환경의 세 가지 측면인 로드, 상호작용, 시각적 안정성에 중점을 두고 있으며 다음 측정항목과 각 기준을 포함한다.

![LCP](https://web.dev/static/articles/vitals/image/largest-contentful-paint-ea2e6ec5569b6.svg?hl=ko)
![FID](https://web.dev/static/articles/vitals/image/first-input-delay-thresho-4329fd6d1129a.svg?hl=ko)
![CLS](https://web.dev/static/articles/vitals/image/cumulative-layout-shift-t-5d49b9b883de4.svg?hl=ko)

LCP(최대 콘텐츠 렌더링 시간): 로드 성능을 측정한다. 페이지가 처음 로드되기 시작한 후 2.5초 이내에 LCP가 발생해야 한다.
FID(최초 입력 반응 시간): 상호 작용을 측정한다. 페이지의 FID 100ms 이하로 유지해야 한다.
CLS(레이아웃 변경 횟수): 시각적 안정성을 측정한다. 페이지의 CLS를 0.1 이하로 유지해야 한다.

**각 측정항목에 대부분의 사용자에게 권장되는 목표에 도달하도록 하려면 모바일과 데스크톱 기기별로 분류된 페이지 로드의 백분위 75 번째 기준을 측정해야 된다.**

# 측정항목 및 기준점

코어 웹 타이탈에는 측정 항목과 각 측정항목의 목표 기준점이 포함되어 있어 개발자가 사이트 환경의 '우수', '개선이 필요한지', '나쁜지' 정성적으로 이해할수 있다.

일반적으로 코어 웹 바이탈 측정항목의 기준점을 선택하는 데 사용되는 접근 방식과 특정 코어 웹 바이탈 측정항목의 기준점이 선택된 방법을 설명한다.

LCP는 인지된 로드 속도를 측정하고 페이지의 주요 컨텐츠가 로드될 가능성이 있을 때 페이지 로드 타임라인의 지점을 표시한다.
FID는 반응성을 측정하고 사용자가 페이이ㅈ와 처음 상호작용하려고 할 때 느끼는 경험을 수치화한다.
CLS는 시각적 안정성을 측정하고 표시되는 페이지 콘텐츠의 예상치 못한 레이아웃 변화의 양을 정량화한다.

측정 항목을 정성적으ㅗㄹ '좋음', '개선이 필요함', '낮음'으로 분류한다.

|                 | 양호        | 낮음        |백분위수|
|:----------------|:----------|:----------|:--|
| 컨텐츠가 포함된 최대 페인트 | 2500ms 이하 | 4000ms 초과 | 75 |
| 최초 입력 반응 시간     | 100ms 이하  | 300ms 초과  | 75 |
| 누적 레이아웃 변경      | 0.1 이하    | 0.25 초과   | 75 |

75번째 백분위수 값은 사이트 페이지 조회 수의 75% 이상이 '좋음'기준을 충족하면 해당 사이트는 해당 측정항목에 대해 '우수한' 실적을 보이는 것으로 분류한다.

반대로 25%이상이 '낮음' 기준점을 충족하면 사이트 성능이 '낮음'으로 분류 된다.

# 코어 웹 바이탈 측정항목 기준점의 기준

코어 웹 바이탈 측정항목의 기준을 설정할 때 먼저 각 기준이 충족해야 하는 기준을 파악했다.
각 측정항목의 기준을 선택하는 데 어떻게 적용되었는지 설명한다.

## 고품질 사용자 경험

주요 목표는 사용자와 사용자 경험 품질에 맞게 최적화이다.

고품질 사용자 환경과 임곗값을 식별하기 위해 인간의 인식과 HCI(Human Computer Interaction) 연구를 살펴본다.

> HCI: 인간과 컴퓨터 간의 상호작용에 대해 연구하여 궁극적으로 사용하기 편리한 시스템을 만들려는 학문
 
이 연구는 단일 고정 임곗값을 사용하며 요약되는 경우도 있지만 기본 연구는 일반적으로 값의 범위로 표현된다.

e.g. 사용자가 포커스를 잃기 전에 일반적으로 대기하는 시간에 관한 연구는 1초로 설명되는 반경, 기본 연구는 실제로 수백 밀리초에서 수 초까지의 범위로 표현된다.

인식 기준은 사용자와 맥락에 따라 다르다는 사실은 집계 및 익명처리된 Chrome 측정항목 데이터를 통해 추가로 확인할 수 있다.
이는 사용자가 페이지 로드를 취소하기 전에 웹페이지에서 콘텐츠가 표시될 때까지 기다리는 시간이 단 한 시간도 없다는 것을 보여준다.
오히려 이 데이터는 원활하고 연속적인 분포를 보여준다.
[웹 바이탈의 과학 이면](https://blog.chromium.org/2020/05/the-science-behind-web-vitals.html)

## 기존 웹 콘텐츠로 달성 가능

사이트 소유자가 '양호' 기준을 충족하도록 사이트를 최적화할 수 있도록 하려면 웹의 기존 콘텐츠에 이러한 기준을 달성할 수 있어야 한다.
현재 출처의 10%이상이 '양호' 기준점을 충족 해야 한다. 잘 최적화된 사이트가 피드 데이터의 가변성으로 인해 잘못 분류되지 않도록 잘 최적화된 콘텐츠가 일관되게 '양호' 기준을 충족한다.

# 백분위수 

전반적인 실적 분류를 위해 페이지 또는 사이트의 모든 방문 수의 75번째 백분위수 값을 사용한다.

1. 백분위수는 페이지 또는 사이트 방문의 대부분의 목표 수준의 성능을 경험했나?
   높은 백분위수 선택이 좋으나 높을 수록 결과 값이 이상점의 양향을 받을 가능성도 높아짐
   불안정한 네트워크 통한 LCP 샘플 지나치게 많아지는 경우 이상점 샘플이 사이트 성능을 결정하지 않도록한다.
2. 선택한 백분위수의 값이 이상점에 지나치게 영향 받으면 안된다.

예를 들어 100회의 방문 사이트에서 95번째 백분위수와 같이 높은 백분위수를 사용하여 사이트의 실적을 평가하는 경우
를 이상점의 영향을 받지 않으려면 5개의 이상점까지만 허용이 된다.
하지만 75번째 백분위수를 사용시 이상점의 영향을 받지 않기까지 25개의 이상점을 허용 할 수 있다. 
그렇다고 하여도 대부분의 사이트 방문(3/4)는 목표 수준의 성능 이상을 경험하기에 적절한 균형을 이루고 있다 할수 있다.

# LCP

## 경험의 질

1초는 종종 사용자가 작업에 집중을 시작하기 전에 기다릴 시간으로 언급된다.
관련 연구를 살펴보면 1초는 대략 수백 밀리초에서 수초에 이르는 값의 범위를 설명하는 근사치이다

일반적으로 인용되는 두가지 출처는 Card et al과 Miller 이다.

> Card et al
> Newell의 통합 인지 이론을 인용하면서 1초 '즉각 응답' 임계값을 정의한다.
> 즉시 응답 이란 약 1초 이내에(0.3초 ~ 3초 사이) 어떤 자극에 대해 이루어져야하는 응답을 의미한다.
> 인지적 고려를 불러일으키는 환경과의 상호 작용은 대략 0.5초 ~ 2-3초 사이의 범위에 있다.

> Miller
> 응답 지연이 2초 이상이고 또 다른 1초 정도의 연장이 가능하면 인간이 기계 통신으로 수행할 수 있고 수행할 작업은 그들의 성격을 심각하게 바꿀것이다.

Card와 Miller의 영구에서 사용자가 초점을 잃을 때까지 기다리는 시간을 약 0.3초에서 3초의 범위로 설명하고 있다.
따라서 First Contentful Paint의 '좋은' 임계값이 1초이고 First Contentful Paint 다음 가장 큰 Contentful Paint발생한다는 것을 고려하면 LCP 임계값 범위를 1~3초로 더욱 제한한다.
기준에 가장 적합한 이범위의 임계값을 선택하기 위해 아래에서는 이러한 후보 임계값의 달성 가능성을 살펴 본다.

## 달성 가능성

최적화가 잘된 사이트에 대하여 LCP 성능을 분석하여 일관되게 달성할 수 있는 임계값을 파악하였다.

'양호' 분류된 CrUX 출처의 비율

        1초	1.5초	2초	2.5초	3초
phone	3.5%	13%	27%	42%	55%
데스크톱	6.9%	19%	36%	51%	64%

실적이 우수한 사이트의 75번째 백분위수에서 일관되게 달성할 수 있는 임곗값을 파악하는 것을 목표로하여 1.5초와 2초 기준점은 일관되게 달성할수 없지만 2.5초는 일관되게 달성할수 있었다.


'불량' 비율

        3초	3.5초	4초	4.5초	5초
phone	45%	35%	26%	20%	15%
데스크톱	36%	26%	19%	14%	10%

4초 기준의 경우 휴대전화 출처의 약 26%, 데스크톱 출체의 21%가 '나쁨'으로 분류된다.
이는 목표 범위인 10~30%에 해당하므로 4초가 '나쁨' 기준점으로 허용된다.

# FID

## 경험의 질

약 100ms의 시각적 피드백 지연은 사용자 입력과 같은 관련 소스에 의해 발생하는 것으로 인식된다.
100ms의 최초 입력 반응 시간 '양호' 기준점이 최소 기준으로 적절할 수 있음을 시사한다. 
입력 처리 지연이 100ms를 초과하면 다른 처리 및 렌더링 단계가 제시간에 완료될 가능성이 없다.

Jakob Nielsen [응답시간: 3가지중요제한](https://www.nngroup.com/articles/response-times-3-important-limits/)에서 사용자가 시스템이 즉시 반응한다고 느낄수 있는 제한으로 0.1초를 정의 하였다.
닐슨은 Michotte의 1962년 인과관계의 인식을 인용한 Miller와 Card를 언급한다

Michotte의 연구에서는 실험 참가자에게 '한 화면에서 두 개의 객체. 객체 A가 출발하여 B를 향해 이동합니다. 
B와 접촉하면 A가 시작되어 A로부터 멀어집니다." Michotte는 객체 A가 중지된 시점과 객체 B가 움직이기 시작하는 시점 간의 시간 간격을 변화시킵니다. Michotte는 최대 약 100ms의 지연 시간에서 참가자가 객체 A가 객체 B의 움직임을 유발한다는 것을 발견했습니다. 약 100밀리초에서 200밀리초 사이의 지연 시간에서는 인과관계에 대한 인식이 혼합되어 있고, 200밀리초 이상의 지연 시간에서는 객체 B의 움직임이 더 이상 객체 A에 의해 발생한 것으로 인식되지 않습니다.
[The psychophysical law of speed estimation in Michotte’s causal events](https://www.sciencedirect.com/science/article/pii/S004269890600352X)
        
최근에는 Kaaresoja등이 [Temporally Perfect Virtual Button](https://dl.acm.org/doi/10.1145/2611387) 조사내용을 공개하였다.
보고서는 터치스크린의 가상 버튼 터치와 다양한 지연 시간에서 버튼이 터치되었음을 나타내는 후속 시각적 피드백 사이의 동시성에 대한 인식에 대한 내용이다.

<=85ms : 시각적 피드백이 버튼 누리가와 동시에 표시된다 인식
<=100ms : 버튼 누리기의 인지된 품질이 높다고 인식
<=150ms : 품질이 저하되었다고 인지
<= 300ms : 매우 낮은 품질로 인지

따라서 임곗값으로 약100ms의 값 범위를 지정하였고 '불량' 임곗값으로 300ms을 지정하였다.

## 달성 가능성

FID 100ms 임계값에 대해 '양호'로 분류된 CrUX 출처의 비율 분석시 웹상의 인기 사이트는 75번째 백분위에서 일관되게 충족 중이다.

      100ms
phone	78%
데스크톱	>99%

# CLS









